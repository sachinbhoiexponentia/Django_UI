Trigger_id,Trigger_Description_Discussed,Assignment_level,Iteration_Level,Trigger_ON_Query_Logic,query
5,dsnjf,3,5,rnejknj,ncdvsdsjkvj
10,If number of riders sold is less than x% of last y policies sold,Policy,nan,(T3_DemoValueSeg_Threshold2>T3_DemoValueSeg_Threshold1),"select '' as id ,'' as id_type,fls_id,trigger_id from threshold_df where  trigger_id = 10 and  Threshold_2 > Threshold_1"
11,If renewal for customer XX tagged to the FLS is due in x days,Policy,Policy,due_Date < datetime.today() +  T11_demosegvalueseg_threshold1,"select a.fls_id as id ,'FR' as id_type,a.fls_id,b.trigger_id from policy_df a left join threshold_df b on a.fls_id = b.fls_id where b.trigger_id = 11  and a.due_date < date_add(current_date(), b.threshold_1) ;"
12,dsnjf,3,5,rnejknj,ncdvsdsjkvj
13,If persistency for the FLS is lower than x%,nan,nan,persistency < T13_demovalueseg_threshold1,".select '' as id ,'' as id_type,a.fls_id,b.trigger_id from policy_df a left join threshold_df b on a.fls_id = b.fls_id where b.trigger_id = 13  and a.persistency >  b.threshold_1) ;"
14,If SI ECS not tagged,nan,nan,"payment_mode !=""D""","select '' as id ,'' as id_type,a.fls_id,b.trigger_id from policy_df a left join threshold_df b on a.fls_id = b.fls_id where b.trigger_id = 11  and  payment_mode !='D'"
16,If FYFP of focus products policies sold is less than x% of total FYFP for last 90 days,Policy,nan,(T16_DemoValueSeg_Threshold2>T16_DemoValueSeg_Threshold1),"select '' as id ,'' as id_type,fls_id,trigger_id from threshold_df where  trigger_id = 16 and  Threshold_2 > Threshold_1"
17,If the customer has a birthday today,Policy,Policy,client_dob==datetime.today(),".select '' as id ,'' as id_type,a.fls_id,b.trigger_id from policy_df a left join threshold_df b on a.fls_id = b.fls_id where b.trigger_id = 17  and a.customer_date_of_birth =current_date()"
19,If FLS has not sold any of the focused products in the last 2 months,Policy,Policy,"policydata[policydata.policyissuancedt<T19_demovaluesegT1 & focus_product=True][""policy_no""].shape[0]=0",nan
22,If number of self generated leads in the last month is less than x ,nan,nan,"lead[lead.leadgenerationdate<(currentmonth-1) & (lead_generation_source=""self)].shape[0]<t22_demovalueseg_threshold1",nan
23,If the FLS doesn't have more than 1 open application ,nan,nan,"leaddata[leaddata.application_status!=""open""].shape[0]<=1","select a.lead_id as id ,'lead' as id_type,a.fls_id,b.trigger_id from lead_df a left join threshold_df b on a.fls_id = b.fls_id where b.trigger_id = 23  and (select count(*) from lead_df where a.application_status <> 'open') <=  b.threshold_1"
26,If there is a look-in cancellation request against the customer id XX,Policy,Policy,poliicy.lookincancellationrequestdate!=np.NAN,nan
34,"If there is a lead X with ""Follow Up"" status against FLS ",Lead,Lead,"leaddata[leaddata.lead_status!=""followup""].shape[0]>=1","select a.lead_id as id ,'lead' as id_type,a.fls_id,b.trigger_id from lead_df a left join threshold_df b on a.fls_id = b.fls_id where b.trigger_id = 23  and (select count(*) from lead_df where lead_status <> 'followup') >=  1"
35,If the FLS is more than 3 months old in system,nan,nan,fls_date_of_joining<datetime.today() - timedelta(days=T35_Threshold3),nan
36,If there has been no application logged in by FLS in past XX days,Lead,Lead,leaddata[leaddata.application_logindate>(datetime.today()-timedelta(dyas=T5_DemoValueSeg_Threshold1)].shape[0]=0,nan
37,If there is an open medical FR ,Application,Application,(fr_med_nonmed==med AND fr_open==True),"select a.fls_id as id ,'FR' as id_type,a.fls_id,b.trigger_id from fr_df a left join threshold_df b on a.fls_id = b.fls_id where b.trigger_id = 37  and a.fr_med_nonmed = 'med' and b.fr_open = 'True' ;"
38,If x days have elapsed since medical FR was raised,Application,Application,(fr_med_nonmed==med AND fr_open==True AND (datetime.today()-FR_generationdate>T38_DemoValueSeg_Threshold1),"select a.fr_id as id ,'FR' as id_type,a.fls_id,b.trigger_id from fr_df a left join threshold_df b on a.fls_id = b.fls_id where b.trigger_id = 38  and a.fr_med_nonmed = 'med' and a.fr_open = 'True'  and datediff(current_date(),a.lead_generation_date) > b.threshold_1"
39,If the average medical FR closing time for the FLS is greater than x days,Application,nan,T39_Threshold2>T39_Threshold1,"select '' as id ,'' as id_type,fls_id,trigger_id from threshold_df where  trigger_id = 39 and  Threshold_2 > Threshold_1"
40,If there is an open non medical FR ,Application,Application,(fr_med_nonmed==nonmed AND fr_open==True),"select a.fls_id as id ,'FR' as id_type,a.fls_id,b.trigger_id from fr_df a left join threshold_df b on a.fls_id = b.fls_id where b.trigger_id = 40  and a.fr_med_nonmed = 'nonmed' and b.fr_open = 'True' ;"
41,If x days have elapsed since non medical FR was raised,Application,Application,(fr_med_nonmed==nonmed AND fr_open==True AND (datetime.today()-FR_generationdate>T41_DemoValueSeg_Threshold1),"select a.fls_id as id ,'FR' as id_type,a.fls_id,b.trigger_id from fr_df a left join threshold_df b on a.fls_id = b.fls_id where b.trigger_id = 41  and a.fr_med_nonmed = 'nonmed' and a.fr_open = 'True'  and datediff(current_date(),a.lead_generation_date) > b.threshold_1"
42,If the average non medical FR closing time for the FLS is greater than x days,Application,Application,T42_DemoValueSeg_threshold2>T42_DemoValueSeg_Threshold1),"select '' as id ,'' as id_type,fls_id,trigger_id from threshold_df where  trigger_id = 42 and  Threshold_2 > Threshold_1"
43,If there is an open single non medical FR ,Application,Application,(fr_med_nonmed==nonmed AND fr_open==True),"select a.fls_id as id ,'FR' as id_type,a.fls_id,b.trigger_id from fr_df a left join threshold_df b on a.fls_id = b.fls_id where b.trigger_id = 43  and a.fr_med_nonmed = 'nonmed' and b.fr_open = 'True' ;"
44,If x days have elapsed since single non medical FR was raised,Application,Application,(fr_med_nonmed==nonmed AND single_flag==True AND single_flag==True AND fr_open==True AND (datetime.today()-FR_generationdate>T44_DemoValueSeg_Threshold1),"select a.fls_id as id ,'FR' as id_type,a.fls_id,b.trigger_id from fr_df a left join threshold_df b on a.fls_id = b.fls_id where b.trigger_id = 44  and datediff(current_date(),a.FR_generationdate) > b.threshold_1 and a.fr_med_nonmed = 'nonmed' and single_flag='True' and fr_open = True ;"
45,If the average single non medical FR closing time for the FLS is greater than x days,Application,nan,(T45_DemoValueSeg_Threshold2>T45_DemoValueSeg_Threshold1),"select '' as id ,'' as id_type,fls_id,trigger_id from threshold_df where  trigger_id = 45 and  Threshold_2 > Threshold_1"
47,If there has been no rider sold in past X days,Policy,Policy,policydata[(policydata.issuancedate >((datetime.today()-x)) & (num_riders>0)].shape[0]==0,nan
48,If there are no focus Product policy sold till date in the month for FLS,nan,Policy,"policydata[((datetime.month(policydata.policy_issuance_date)==datetime.today().month()) AND policy.focusgroup.isin(flsdetails[flsdetails==fls_id][""focusgroup""].to_list()].shape[0]=0",nan
49,If renewal for customer XX tagged to the FLS is not received within 7-30 days after due date ,Policy,Policy,ptddate<due_Date+N,nan
54,If FLS has been in the system for x days & not completed corresponding mlearn training in last x days ,nan,nan,fls_details.date_of_joining - datetime.today()> T54_demovalueseg_threshold1 & training_result!=completed,".select '' as id ,'policy' as id_type,a.fls_id,b.trigger_id from policy_df a left join threshold_df b on a.fls_id = b.fls_id where b.trigger_id = 54  and datediff(current_date(),a.FR_generationdate) > b.threshold_1) ;"
55,If FLS has not completed SI/ECS mandate task for a given policy in last 30 days,nan,Optimization_Output,"task_no=11 & task_status=""Missed""",nan
58,If there has been >1 application logged in by FLS in past XX days,nan,nan,"[leaddata[applogindt>""T58_demovaleseg_threshold1][""application_no""].shape[0]>0",nan
101,"Policy Status == 'IF""",nan,Policy,Policy Status =='True',nan
102,Repetitive Task =='No',nan,nan,Repetitive Task =='No',nan
121,dsnjf,3,5,rnejknj,ncdvsdsjkvj
21312,dsnjf,3,5,rnejknj,ncdvsdsjkvj
213129,dsnjf,3,5,rnejknj,ncdvsdsjkvj
